import dataAnalyzer from "../helpers/dataAnalyze.js";

export default class Mean{
    losses = [];
    mode = '';
    validationLoss = undefined;
    constructor(name , showAnalytics=false){
        this.name = name;
        this.showAnalytics = showAnalytics;
    }

    backword(isValidate=false){
        this.mode = ''
        if(isValidate) this.mode = "Validation ";
        return this.#log()
    }

    #log(){
        let error = this.losses.reduce((acc, curr)=> acc + curr , 0);
        error /= this.losses.length; 
        let analyzeText = '';
        if(this.name == "Accuracy" && this.showAnalytics){
            analyzeText = JSON.stringify(dataAnalyzer(this.losses.map(value=> new Array(1).fill(value))).percentages);
        }
        this.#reset();
        this.validationLoss = error;

        return `${this.mode + this.name} : ${error}  ${analyzeText}`;

    }

    

    #reset(){
        this.losses = [];
    }
}
